<div class="consulta-edit-container">
  <mat-card class="consulta-edit-card">
    <mat-card-header class="card-header">
      <mat-icon class="header-icon">edit</mat-icon>
      <mat-card-title>Editar Consulta</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="consultaForm" (ngSubmit)="onSubmit()" *ngIf="!loading">
        <!-- Profissional Responsavel -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Profissional Responsavel</mat-label>
          <input
            matInput
            type="number"
            formControlName="profissionalId"
            placeholder="ID do profissional"
          />
          <mat-icon matSuffix>badge</mat-icon>
          <mat-error
            *ngIf="consultaForm.get('profissionalId')?.hasError('required')"
          >
            Campo obrigatorio
          </mat-error>
        </mat-form-field>

        <!-- Tipo de Consulta -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Tipo de Consulta</mat-label>
          <mat-select formControlName="tipoConsulta">
            <mat-option *ngFor="let tipo of tiposConsulta" [value]="tipo">
              {{ tipo }}
            </mat-option>
          </mat-select>
          <mat-icon matSuffix>category</mat-icon>
          <mat-error
            *ngIf="consultaForm.get('tipoConsulta')?.hasError('required')"
          >
            Campo obrigatorio
          </mat-error>
        </mat-form-field>

        <!-- Data da Consulta -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Data da Consulta</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            formControlName="dataConsulta"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error
            *ngIf="consultaForm.get('dataConsulta')?.hasError('required')"
          >
            Campo obrigatorio
          </mat-error>
        </mat-form-field>

        <!-- Queixa Principal -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Queixa Principal</mat-label>
          <textarea
            matInput
            formControlName="queixaPrincipal"
            rows="3"
            placeholder="Descreva a queixa principal do paciente"
          ></textarea>
          <mat-icon matSuffix>description</mat-icon>
          <mat-error
            *ngIf="consultaForm.get('queixaPrincipal')?.hasError('required')"
          >
            Campo obrigatorio
          </mat-error>
        </mat-form-field>

        <!-- Historia da Doenca Atual -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Historia da Doenca Atual</mat-label>
          <textarea
            matInput
            formControlName="historiaDoencaAtual"
            rows="4"
            placeholder="Descreva a historia da doenca atual"
          ></textarea>
          <mat-icon matSuffix>history</mat-icon>
        </mat-form-field>

        <!-- Exame Fisico -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Exame Fisico</mat-label>
          <textarea
            matInput
            formControlName="exameFisico"
            rows="4"
            placeholder="Descricao do exame fisico realizado"
          ></textarea>
          <mat-icon matSuffix>health_and_safety</mat-icon>
        </mat-form-field>

        <!-- Hipotese Diagnostica -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Hipotese Diagnostica</mat-label>
          <textarea
            matInput
            formControlName="hipoteseDiagnostica"
            rows="3"
            placeholder="Hipotese diagnostica inicial"
          ></textarea>
          <mat-icon matSuffix>lightbulb</mat-icon>
        </mat-form-field>

        <!-- Diagnostico -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Diagnostico Final</mat-label>
          <textarea
            matInput
            formControlName="diagnostico"
            rows="3"
            placeholder="Diagnostico confirmado"
          ></textarea>
          <mat-icon matSuffix>check_circle</mat-icon>
        </mat-form-field>

        <!-- Tratamento -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Tratamento Proposto</mat-label>
          <textarea
            matInput
            formControlName="tratamento"
            rows="4"
            placeholder="Descricao do tratamento proposto"
          ></textarea>
          <mat-icon matSuffix>medication</mat-icon>
        </mat-form-field>

        <!-- Observacoes -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Observacoes</mat-label>
          <textarea
            matInput
            formControlName="observacoes"
            rows="3"
            placeholder="Observacoes adicionais"
          ></textarea>
          <mat-icon matSuffix>notes</mat-icon>
        </mat-form-field>

        <!-- Botoes de Acao -->
        <div class="form-actions">
          <button
            mat-raised-button
            type="button"
            (click)="goBack()"
            [disabled]="loading"
          >
            <mat-icon>arrow_back</mat-icon>
            Cancelar
          </button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="loading"
          >
            <mat-icon>save</mat-icon>
            {{ loading ? "Salvando..." : "Salvar Alteracoes" }}
          </button>
        </div>
      </form>

      <!-- Loading State -->
      <div *ngIf="loading" class="loading-container">
        <mat-icon class="loading-icon">hourglass_empty</mat-icon>
        <p>Carregando dados da consulta...</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<!--
   __  ____ ____ _  _
 / _\/ ___) ___) )( \
/    \___ \___ ) \/ (
\_/\_(____(____|____/
-->
